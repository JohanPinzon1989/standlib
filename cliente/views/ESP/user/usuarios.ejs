<%- include ('../partials/User/header') %>

<% usuario.forEach((puser)=> { 
  if (puser.Perfil == "Administrador") {%>
  <!--  Header Start -->
  <%- include ('../partials/User/head') %>
  <%- include ('../partials/user/NavUsuario') %>
  <!--  Header End -->
    <div class="container-fluid" style="overflow:scroll;height: calc(115vh - 80px);">
      <div class="container-fluid">
        <div class="card">
          <div class="card-body">
            <h5 class="card-title fw-semibold mb-4">Listado de usuarios</h5>
            <div class="card">
              <div class="card-body">
                <table class="table">
                  <thead class="table-light">
                    <tr>
                      <th ">
          <h6 class=" fw-semibold mb-0 fs-4">Id</h6>
                      </th>
                      <th ">
          <h6 class=" fw-semibold mb-0 fs-4">Nombre</h6>
                      </th>
                      <th ">
          <h6 class=" fw-semibold mb-0 fs-4">Apellido</h6>
                      </th>
                      <th ">
          <h6 class=" fw-semibold mb-0 fs-4">Correo</h6>
                      </th>
                      <th ">
          <h6 class=" fw-semibold mb-0 fs-4">Estado</h6>
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    <% results.forEach((user)=> { %>
                      <tr>
                        <td ">
            <h6 ><%= user.Id %></h6>
          </td>
          <td ">
                          <h6>
                            <%= user.Nombre %>
                          </h6>
                        </td>
                        <td ">
            <h6 ><%= user.Apellido %></h6>
          </td>
          <td ">
                          <h6 class="fw-semibold mb-0">
                            <%= user.Email %>
                          </h6>
                        </td>
                        <td ">
            <h6 class=" fw-semibold mb-0">
                          <%= user.Estado %>
                            </h6>
                        </td>
                        <td >
                          <div class="btn-group dropend">
                            <button class="btn btn-secondary ti ti-list-check" type="button" data-bs-toggle="dropdown" data-bs-auto-close="true" aria-expanded="false">
                            </button>
                            <ul class="dropdown-menu">
                              <li><a type="button" class="dropdown-item" data-bs-toggle="modal" data-bs-target="#Modal<%= user.Id %>">Editar</a></li>
                              <li><a type="button" class="dropdown-item" data-bs-toggle="modal" data-bs-target="#ModalP<%= user.Id %>">Cambio de contraseña</a></li>
                              <li><a type="button" class="dropdown-item" href="/dUserCLI/<%= user.Id %>">Eliminar</a></li>
                        </td>
                      </tr>

                      
                  </tbody>
<!--Editar Usuario del cliente-->
<div class="modal fade" id="Modal<%= user.Id %>" data-bs-backdrop="static">
  <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Editar registro</h5>
        <button class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form action="/actualizarCU" method="POST">
          <input id="Id" name="Id" value="<%= user.Id %>" type="hidden" />
          <div class="mb-3">
            <label for="Nombre" class="form-label">Nombre</label>
            <input
              value="<%= user.Nombre %>"
              placeholder="STANDLIB SAS"
              type="text"
              class="form-control"
              name="Nombre"
              id="Nombre"
              aria-describedby="textHelp"
              required
            />
          </div>
          <div class="mb-3">
            <label for="Apellido" class="form-label">Apellido</label>
            <input
              value="<%= user.Apellido %>"
              placeholder="STANDLIB SAS"
              type="text"
              class="form-control"
              name="Apellido"
              id="Apellido"
              aria-describedby="textHelp"
              required
            />
          </div>
          <div class="mb-3">
            <label for="Email" class="form-label">Correo de contacto</label>
            <input
              value="<%= user.Email %>"
              placeholder="standlib.com"
              type="text"
              class="form-control"
              name="Email"
              id="Email"
              aria-describedby="textHelp"
              required
            />
          </div>
          <div class="mb-3">
            <label for="Num_Fijo" class="form-label">Numero fijo</label>
            <input
              value="<%= user.Num_Fijo %>"
              placeholder="standlib.com"
              type="text"
              class="form-control"
              name="Num_Fijo"
              id="Num_Fijo"
              aria-describedby="textHelp"
              required
            />
          </div>
          <div class="mb-3">
            <label for="Num_Celular" class="form-label">Numero celular</label>
            <input
              value="<%= user.Num_Celular %>"
              placeholder="standlib.com"
              type="text"
              class="form-control"
              name="Num_Celular"
              id="Num_Celular"
              aria-describedby="textHelp"
              required
            />
          </div>
          <div class="mb-3">
            <label for="Perfil" class="form-label">Perfil</label>
            <select
              class="form-control"
              name="Perfil"
              id="Perfil"
              aria-describedby="text"
              required
            >
              <option  value="Administrador" <%= user.Perfil=='Administrador' ? "selected" : '' %> >Administrador</option>
              <option  value="Editor" <%= user.Perfil=='Editor' ? "selected" : '' %> >Editor</option>
              <option  value="Lector" <%= user.Perfil=='Lector' ? "selected" : '' %> >Lector</option>
            </select>
          </div>                   
          <div class="mb-3">
            <label for="Estado" class="form-label">Estado</label>
            <select
              class="form-control"
              name="Estado"
              id="Estado"
              aria-describedby="text"
              required
            >
              <option  value="Activo" <%= user.Estado=='Activo' ? "selected" : '' %> >Activo</option>
              <option  value="Bloqueado" <%= user.Estado=='Bloqueado' ? "selected" : '' %> >Bloqueado</option>
            </select>
          </div>
          <div class="mb-3">
            <label for="Estado_ing" class="form-label">Estado en ingles</label>
            <select
              class="form-control"
              name="Estado_ing"
              id="Estado_ing"
              aria-describedby="text"
              required
            >
              <option  value="Active" <%= user.Estado=='Active' ? "selected" : '' %> >Active</option>
              <option  value="Locked" <%= user.Estado=='Locked' ? "selected" : '' %> >Locked</option>
            </select>
          </div>
          <div class="mb-3">
            <label for="Publicidad" class="form-label">Publicidad</label>
            <select
              class="form-control"
              name="Publicidad"
              id="Publicidad"
              aria-describedby="text"
              required
            >
              <option  value="Si" <%= user.Publicidad=='Si' ? "selected" : '' %> >Si</option>
              <option  value="No" <%= user.Publicidad=='No' ? "selected" : '' %> >No</option>
            </select>
          </div>                  
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" type="submit">Guardar</button>
      </form>
        <button class="btn btn-danger" data-bs-dismiss="modal">Cancelar</button>
        
      </div>
    </div>
  </div>
</div>
<!--Editar contraseña Usuario del cliente-->
<div class="modal fade" id="ModalP<%= user.Id %>" data-bs-backdrop="static">
  <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cambiar contraseña</h5>
        <button class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <form action="/actualizarCcP" method="POST">
          <input id="Id" name="Id" value="<%= user.Id %>" type="hidden" />
          <div class="mb-3">
            <label for="password" class="form-label">Nueva contraseña</label>
            <input
              placeholder="Requiere caracteres en mayuscula, numericos y especiales"
              type="password"
              class="form-control"
              name="password"
              id="password"
              aria-describedby="textHelp"
              required
            />
          </div>
                            
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" type="submit">Cambiar</button>
      </form>
        <button class="btn btn-danger" data-bs-dismiss="modal">Cancelar</button>
        
      </div>
    </div>
  </div>
</div>
                  <% }) %>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
<% }else{
  if (puser.Perfil == "Editor") { %>
    <!--  Header Start -->
  <%- include ('../partials/User/headED') %>
  <%- include ('../partials/user/NavUsuario') %>
  <!--  Header End -->
  <div class="container-fluid" style="overflow:scroll;height: calc(115vh - 80px);">
    <div class="container-fluid">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title fw-semibold mb-4">Listado de usuarios</h5>
          <div class="card">
            <div class="card-body">
              <table class="table">
                <thead class="table-light">
                  <tr>
                    <th ">
        <h6 class=" fw-semibold mb-0 fs-4">Id</h6>
                    </th>
                    <th ">
        <h6 class=" fw-semibold mb-0 fs-4">Nombre</h6>
                    </th>
                    <th ">
        <h6 class=" fw-semibold mb-0 fs-4">Apellido</h6>
                    </th>
                    <th ">
        <h6 class=" fw-semibold mb-0 fs-4">Correo</h6>
                    </th>
                    <th ">
        <h6 class=" fw-semibold mb-0 fs-4">Estado</h6>
                    </th>
                  </tr>
                </thead>
                <tbody>
                  <% results.forEach((user)=> { %>
                    <tr>
                      <td ">
          <h6 ><%= user.Id %></h6>
        </td>
        <td ">
                        <h6>
                          <%= user.Nombre %>
                        </h6>
                      </td>
                      <td ">
          <h6 ><%= user.Apellido %></h6>
        </td>
        <td ">
                        <h6 class="fw-semibold mb-0">
                          <%= user.Email %>
                        </h6>
                      </td>
                      <td ">
          <h6 class=" fw-semibold mb-0">
                        <%= user.Estado %>
                          </h6>
                      </td>
                      <td >
                        <div class="btn-group dropend">
                          <button class="btn btn-secondary ti ti-list-check" type="button" data-bs-toggle="dropdown" data-bs-auto-close="true" aria-expanded="false">
                          </button>
                          <ul class="dropdown-menu">
                            <li><a type="button" class="dropdown-item" data-bs-toggle="modal" data-bs-target="#Modal<%= user.Id %>">Editar</a></li>
                            <li><a type="button" class="dropdown-item" data-bs-toggle="modal" data-bs-target="#ModalP<%= user.Id %>">Cambio de contraseña</a></li>
                            <li><a type="button" class="dropdown-item" href="/dUserCLI/<%= user.Id %>">Eliminar</a></li>
                      </td>
                    </tr>

                    
                </tbody>
<!--Editar Usuario del cliente-->
<div class="modal fade" id="Modal<%= user.Id %>" data-bs-backdrop="static">
<div class="modal-dialog modal-dialog-scrollable modal-dialog-centered">
  <div class="modal-content">
    <div class="modal-header">
      <h5 class="modal-title">Editar registro</h5>
      <button class="btn-close" data-bs-dismiss="modal"></button>
    </div>
    <div class="modal-body">
      <form action="/actualizarCU" method="POST">
        <input id="Id" name="Id" value="<%= user.Id %>" type="hidden" />
        <div class="mb-3">
          <label for="Nombre" class="form-label">Nombre</label>
          <input
            value="<%= user.Nombre %>"
            placeholder="STANDLIB SAS"
            type="text"
            class="form-control"
            name="Nombre"
            id="Nombre"
            aria-describedby="textHelp"
            required
          />
        </div>
        <div class="mb-3">
          <label for="Apellido" class="form-label">Apellido</label>
          <input
            value="<%= user.Apellido %>"
            placeholder="STANDLIB SAS"
            type="text"
            class="form-control"
            name="Apellido"
            id="Apellido"
            aria-describedby="textHelp"
            required
          />
        </div>
        <div class="mb-3">
          <label for="Email" class="form-label">Correo de contacto</label>
          <input
            value="<%= user.Email %>"
            placeholder="standlib.com"
            type="text"
            class="form-control"
            name="Email"
            id="Email"
            aria-describedby="textHelp"
            required
          />
        </div>
        <div class="mb-3">
          <label for="Num_Fijo" class="form-label">Numero fijo</label>
          <input
            value="<%= user.Num_Fijo %>"
            placeholder="standlib.com"
            type="text"
            class="form-control"
            name="Num_Fijo"
            id="Num_Fijo"
            aria-describedby="textHelp"
            required
          />
        </div>
        <div class="mb-3">
          <label for="Num_Celular" class="form-label">Numero celular</label>
          <input
            value="<%= user.Num_Celular %>"
            placeholder="standlib.com"
            type="text"
            class="form-control"
            name="Num_Celular"
            id="Num_Celular"
            aria-describedby="textHelp"
            required
          />
        </div>
        <div class="mb-3">
          <label for="Perfil" class="form-label">Perfil</label>
          <select
            class="form-control"
            name="Perfil"
            id="Perfil"
            aria-describedby="text"
            required
          >
            <option  value="Administrador" <%= user.Perfil=='Administrador' ? "selected" : '' %> >Administrador</option>
            <option  value="Editor" <%= user.Perfil=='Editor' ? "selected" : '' %> >Editor</option>
            <option  value="Lector" <%= user.Perfil=='Lector' ? "selected" : '' %> >Lector</option>
          </select>
        </div>                   
        <div class="mb-3">
          <label for="Estado" class="form-label">Estado</label>
          <select
            class="form-control"
            name="Estado"
            id="Estado"
            aria-describedby="text"
            required
          >
            <option  value="Activo" <%= user.Estado=='Activo' ? "selected" : '' %> >Activo</option>
            <option  value="Bloqueado" <%= user.Estado=='Bloqueado' ? "selected" : '' %> >Bloqueado</option>
          </select>
        </div>
        <div class="mb-3">
          <label for="Estado_ing" class="form-label">Estado en ingles</label>
          <select
            class="form-control"
            name="Estado_ing"
            id="Estado_ing"
            aria-describedby="text"
            required
          >
            <option  value="Active" <%= user.Estado=='Active' ? "selected" : '' %> >Active</option>
            <option  value="Locked" <%= user.Estado=='Locked' ? "selected" : '' %> >Locked</option>
          </select>
        </div>
        <div class="mb-3">
          <label for="Publicidad" class="form-label">Publicidad</label>
          <select
            class="form-control"
            name="Publicidad"
            id="Publicidad"
            aria-describedby="text"
            required
          >
            <option  value="Si" <%= user.Publicidad=='Si' ? "selected" : '' %> >Si</option>
            <option  value="No" <%= user.Publicidad=='No' ? "selected" : '' %> >No</option>
          </select>
        </div>                  
    </div>
    <div class="modal-footer">
      <button class="btn btn-secondary" type="submit">Guardar</button>
    </form>
      <button class="btn btn-danger" data-bs-dismiss="modal">Cancelar</button>
      
    </div>
  </div>
</div>
</div>
<!--Editar contraseña Usuario del cliente-->
<div class="modal fade" id="ModalP<%= user.Id %>" data-bs-backdrop="static">
<div class="modal-dialog modal-dialog-scrollable modal-dialog-centered">
  <div class="modal-content">
    <div class="modal-header">
      <h5 class="modal-title">Cambiar contraseña</h5>
      <button class="btn-close" data-bs-dismiss="modal"></button>
    </div>
    <div class="modal-body">
      <form action="/actualizarCcP" method="POST">
        <input id="Id" name="Id" value="<%= user.Id %>" type="hidden" />
        <div class="mb-3">
          <label for="password" class="form-label">Nueva contraseña</label>
          <input
            placeholder="Requiere caracteres en mayuscula, numericos y especiales"
            type="password"
            class="form-control"
            name="password"
            id="password"
            aria-describedby="textHelp"
            required
          />
        </div>
                          
    </div>
    <div class="modal-footer">
      <button class="btn btn-secondary" type="submit">Cambiar</button>
    </form>
      <button class="btn btn-danger" data-bs-dismiss="modal">Cancelar</button>
      
    </div>
  </div>
</div>
</div>
                <% }) %>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
  <% }else { %>
    <%- include ('../partials/User/headLE') %>
<!--  Header End -->
<div class="container-fluid" style="overflow:scroll;height: calc(115vh - 80px);">
  <div class="container-fluid">
    <div class="card">
      <div class="card-body">
        <h5 class="card-title fw-semibold mb-4"></h5>
        <div class="card">
          <div class="card-body">
            <h1> No tiene los permisos requeridos</h1>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
</div>
  
<% }}}) %>

  <%-include('../partials/User/footer') %>